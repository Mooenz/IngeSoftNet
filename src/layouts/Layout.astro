---
import Menu from '@sections/Menu.astro';
import Footer from '@sections/Footer.astro';
import ButtonLateral from '@components/ButtonLateral.astro';
import favicon from '@public/images/favicon.png';
import ogImage from '@/assets/og-image.png';
import '@styles/global.css';
export interface Props {
	title: string;
	description?: string;
	keywords?: string;
}

const { title, description, keywords } = Astro.props;
---

<html lang="es">
	<head>
		<!-- Meta básicos optimizados -->
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
		

		<!-- SEO Meta Tags -->
		<title>{title}</title>
		{description && <meta name="description" content={description} />}
		{keywords && <meta name="keywords" content={keywords} />}
		<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
		<meta name="author" content="IngeSoftNet" />
		<link rel="icon" type="image/x-icon" href={favicon.src} />
		<link rel="canonical" href="https://ingesoftnet.com" />

		<!-- Open Graph (Redes Sociales) -->
		<meta property="og:type" content="website" />
		<meta property="og:title" content={title} />
		{description && <meta property="og:description" content={description } />}
		<meta property="og:url" content='https://ingesoftnet.com' />
		<meta property="og:site_name" content="IngeSoftNet" />
		<meta property="og:image" content={ogImage.src} />
		<meta property="og:image:width" content="1200" />
		<meta property="og:image:height" content="630" />
		<meta property="og:image:alt" content={`${title} - IngeSoftNet`} />
		<meta property="og:locale" content="es_CO" />

		<!-- Twitter Cards -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content={title} />
		{description && <meta name="twitter:description" content={description} />}
		<meta name="twitter:image" content={ogImage.src} />
		<meta name="twitter:image:alt" content={`${title} - IngeSoftNet`} />


		<!-- Datos estructurados básicos (JSON-LD) -->
		<script type="application/ld+json">
			{
				JSON.stringify({
					"@context": "https://schema.org",
					"@type": "Organization",
					"name": "IngeSoftNet",
					"url": "https://ingesoftnet.com",
					"logo": Astro.url.origin + "/images/logo.png",
					"description": description || "Soluciones de software e ingeniería",
					"address": {
						"@type": "PostalAddress",
						"addressLocality": "Ibagué",
						"addressRegion": "Tolima",
						"addressCountry": "CO"
					}
				})
			}
		</script>	
		<body>
			<Menu />
			<main>
				<slot />
			</main>
			<Footer />
			<ButtonLateral />

			<!-- Botón volver arriba -->
		<button class="btn-volver-arriba" id="volver-arriba">
			<i class="fi fi-rr-arrow-small-up"></i>
		</button>
		</body>

	</head>
 </html>

 <script>
	// Script para fijar el menú cuando se scrollea más del 80% del header
	const header = document.getElementById('hero-principal'); // Ajusta el selector según tu HTML
	const menu = document.getElementById('menu-principal');
	function handleScroll() {
		// Si no existe header o menu, salir
		if (!header || !menu) return;

		// Obtener la altura del header
		const headerHeight = header.offsetHeight;
		
		// Calcular el 80% de la altura del header
		const threshold = headerHeight * 0.8;
		
		// Obtener la posición actual del scroll
		const scrollPosition = window.scrollY;
		
		// Si el scroll supera el 80% del header
		if (scrollPosition > threshold) {
			// Agregar clase para fijar el menú
			menu.classList.add('fixed-menu');
		} else {
			// Remover clase cuando vuelve arriba
			menu.classList.remove('fixed-menu');
		}
	}

	// Escuchar el evento scroll
	window.addEventListener('scroll', handleScroll);

	// Ejecutar una vez al cargar para verificar posición inicial
	handleScroll();

	// Animación de enlaces con data-hover
	const links = document.querySelectorAll<HTMLElement>('.animation-link');

	links.forEach(link => {
		const text = link.textContent;

		// Crear el span y mover el contenido dentro
		const span = document.createElement('span');
		span.textContent = text;

		// Limpiar contenido y agregar el span
		link.textContent = '';
		link.appendChild(span);

		// Asignar el atributo data-hover
		link.setAttribute('data-hover', text);
	});
	
	// Smooth Scroll para enlaces de ancla
	document.addEventListener('DOMContentLoaded', () => {
		// Cuando se de click a un enlace de ancla, hacer scroll suave se ubica 80px abajo del elemento
		document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
			anchor.addEventListener('click', function (e) {
				e.preventDefault();
				const targetId = this.getAttribute('href').substring(1);
				const targetElement = document.getElementById(targetId);
				if (targetElement) {
					const offset = 52;
					const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;
					const offsetPosition = elementPosition - offset;
					window.scrollTo({
						top: offsetPosition,
						behavior: 'smooth',
					});
				}
			});
		});
	});

		// Botón de volver al inicio de la documentación
	const backToTopButton = document.querySelector('#volver-arriba');
	const documentacion = document.querySelector('#menu-principal');

	if (backToTopButton && documentacion) {
		backToTopButton.addEventListener('click', () => {
			documentacion.scrollIntoView({
				behavior: 'smooth',
				block: 'start',
			});
		});
	}

		// Si el usuario esta en el inicio de la documentación, ocultamos el botón de volver al inicio
	const inicio = document.querySelector('#menu-principal');
	if (inicio && backToTopButton) {
		const observer2 = new IntersectionObserver(
			(entries) => {
				entries.forEach((entry) => {
					if (entry.isIntersecting) {
						backToTopButton.classList.remove('activo');
					} else {
						backToTopButton.classList.add('activo');
					}
				});
			},
			{
				threshold: 0.2,
			}
		);

		observer2.observe(inicio);
	}
 </script>

<style>
.btn-volver-arriba {
	position: fixed;
	bottom: 20px;
	left: 20px;
	z-index: 9999;
	width: 50px;
	height: 50px;
	display: flex;
	align-items: center;
	justify-content: center;
	border-radius: 50%;
	background-color: var(--color-primary-dark);
	color: #fff;
	border: none;
	cursor: pointer;
	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
	font-size: 1.5rem;
	transform: scale(0);
	transition: transform ease-in-out 0.3s;
}

.btn-volver-arriba.activo {
	transform: scale(1);
}
</style>